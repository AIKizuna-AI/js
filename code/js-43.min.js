var koe_43_type_name={1:'播放',3:'评论',2:'弹幕',8:'点赞',4:'分享',5:'硬币',6:'收藏',7:'充电',};if(typeof formatDate==='undefined'){function formatDate(date){var date=new Date(date*1000);var YY=date.getFullYear()+'-';var MM=(date.getMonth()+1<10?'0'+(date.getMonth()+1):date.getMonth()+1)+'-';var DD=date.getDate()<10?'0'+date.getDate():date.getDate();return YY+MM+DD}}var koe_43_current_index=0;var koe_43_data=new Array();koe_43_data.push(','+Object.keys(koe_43_type_name).map(function(item){return koe_43_type_name[item]}).join(','));var koe_43_xhr_data=new Array();var koe_43_date=new Array();var koe_43_date_is_complete=false;koe_43_getData();function koe_43_getData(){var koe_43_keys=Object.keys(koe_43_type_name);var koe_43_xhr=new XMLHttpRequest();koe_43_xhr.open('GET','https://member.bilibili.com/x/web/data/pandect?type='+koe_43_keys[koe_43_current_index],'true');koe_43_xhr.send();koe_43_xhr.onreadystatechange=function(){if(koe_43_xhr.readyState===4&&koe_43_xhr.status===200){var json=JSON.parse(koe_43_xhr.responseText);koe_43_xhr_data[koe_43_keys[koe_43_current_index]]=new Array();json.data.forEach(function(item){if(!koe_43_date_is_complete){koe_43_date.push(formatDate(item.date_key))}koe_43_xhr_data[koe_43_keys[koe_43_current_index]].push(item.total_inc)});koe_43_date_is_complete=true;if(koe_43_keys.length-1===koe_43_current_index){koe_43_date.forEach(function(item,index){var data_everyday=new Array();koe_43_keys.forEach(function(type_index){data_everyday.push(koe_43_xhr_data[type_index][index])});koe_43_data.push(item+','+data_everyday.join(','))});const blob=new Blob(['\ufeff'+koe_43_data.join('\n')],{type:'text/csv,charset=UTF-8',});const csvUrl=URL.createObjectURL(blob);let link=document.createElement('a');link.download=koe_43_date[koe_43_date.length-1].replace(/-/g,'')+'-'+koe_43_date[0].replace(/-/g,'')+'.csv';link.href=csvUrl;link.click()}else{++koe_43_current_index;koe_43_getData()}}}};/*{"name":"视频数据保存"}*/